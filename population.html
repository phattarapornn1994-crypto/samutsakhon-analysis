<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ & ‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£</title>

    <style>
      body {
        background: #0f172a;
        color: #f8fafc;
        font-family: system-ui, sans-serif;
        margin: 0;
        min-height: 100vh;
        display: grid;
        grid-template-rows: auto 1fr auto;
      }

      header {
        background: #1e293b;
        padding: 12px 16px;
        border-bottom: 1px solid #334155;
        font-size: 14px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      header nav a {
        color: #94a3b8;
        margin-right: 12px;
        text-decoration: none;
        font-size: 13px;
      }

      header nav a:hover {
        color: #fff;
      }

      main {
        padding: 24px clamp(16px, 2vw, 32px);
        max-width: 1200px;
        width: 100%;
        margin: 0 auto;
        display: grid;
        gap: 24px;
      }

      .card {
        background: #1e253b80;
        background: radial-gradient(
            circle at 0% 0%,
            rgba(30, 41, 59, 0.9) 0%,
            rgba(15, 23, 42, 0.8) 60%
          ),
          #0f172a;
        border: 1px solid #334155;
        border-radius: 16px;
        padding: 20px 24px;
        box-shadow: 0 30px 80px rgb(0 0 0 / 0.8);
      }

      .section-title {
        font-size: 14px;
        font-weight: 600;
        color: #fff;
        margin: 0 0 8px;
        line-height: 1.4;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 8px;
      }

      .subtle {
        font-size: 12px;
        color: #94a3b8;
        font-weight: 400;
        line-height: 1.4;
      }

      .quick-stats {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        font-size: 13px;
        color: #cbd5e1;
      }

      .stat-box {
        background: rgba(30, 41, 59, 0.4);
        border: 1px solid #47556966;
        border-radius: 12px;
        padding: 12px 16px;
        min-width: 140px;
      }

      .stat-label {
        font-size: 11px;
        line-height: 1.4;
        color: #94a3b8;
      }

      .stat-value {
        font-size: 16px;
        font-weight: 600;
        color: #fff;
        line-height: 1.3;
      }

      .two-col {
        display: grid;
        grid-template-columns: 1fr;
        gap: 24px;
      }
      @media (min-width: 900px) {
        .two-col {
          grid-template-columns: 1fr 1fr;
        }
      }

      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 12px;
        line-height: 1.4;
        color: #cbd5e1;
        min-width: 100%;
        overflow-x: auto;
      }

      thead {
        background: #1e293b;
        color: #fff;
      }

      th {
        text-align: left;
        font-weight: 500;
        padding: 10px 12px;
        border-bottom: 1px solid #334155;
        font-size: 12px;
        white-space: nowrap;
      }

      tbody tr:nth-child(even) {
        background: rgba(30, 41, 59, 0.3);
      }

      td {
        padding: 10px 12px;
        border-bottom: 1px solid #33415566;
        vertical-align: top;
        white-space: nowrap;
      }

      .cluster-badge {
        display: inline-block;
        font-size: 11px;
        line-height: 1.2;
        padding: 4px 8px;
        border-radius: 8px;
        font-weight: 600;
      }

      .cluster-A {
        background: rgba(220, 38, 38, 0.2);
        color: #f87171;
        border: 1px solid rgba(248, 113, 113, 0.4);
      }

      .cluster-B {
        background: rgba(251, 191, 36, 0.15);
        color: #facc15;
        border: 1px solid rgba(250, 204, 21, 0.4);
      }

      .cluster-C {
        background: rgba(34, 197, 94, 0.15);
        color: #4ade80;
        border: 1px solid rgba(74, 222, 128, 0.4);
      }

      footer {
        color: #475569;
        background: #0f172a;
        font-size: 12px;
        text-align: center;
        padding: 12px 0 16px;
        border-top: 1px solid #334155;
      }

      code.inline {
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid #334155;
        border-radius: 6px;
        padding: 2px 6px;
        color: #7dd3fc;
        font-size: 11px;
      }
    </style>
  </head>

  <body>
    <!-- Navbar -->
    <header>
      <div style="font-weight:600; color:#fff; font-size:13px;">
        üìä ‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£ Data Dashboard
      </div>
      <nav>
        <a href="index.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
        <a href="map.html">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</a>
        <a href="population.html" style="color:#fff;">‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</a>
        <a href="competition.html">‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</a>
        <a href="risk.html">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</a>
      </nav>
    </header>

    <main>
      <!-- ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° -->
      <section class="card">
        <div class="section-title">
          <div>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ & ‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£</div>
          <div class="subtle">
            ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå API ‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞‡πÉ‡∏ô repo (<code class="inline">/data/*.json</code>)
          </div>
        </div>

        <div class="quick-stats" id="quickStats">
          <!-- ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
        </div>
      </section>

      <div class="two-col">
        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ -->
        <section class="card">
          <div class="section-title">
            <div>‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡∏ö‡∏•</div>
            <div class="subtle">
              ‡∏£‡∏∞‡∏ö‡∏∏ cluster (K-means) / class (‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô)
            </div>
          </div>

          <div style="overflow-x:auto;">
            <table>
              <thead>
                <tr>
                  <th>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</th>
                  <th>‡∏ï‡∏≥‡∏ö‡∏•</th>
                  <th>Population</th>
                  <th>Cluster</th>
                  <th>Lat</th>
                  <th>Lng</th>
                </tr>
              </thead>
              <tbody id="populationTableBody">
                <!-- ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô -->
        <section class="card">
          <div class="section-title">
            <div>‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô (‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡πÅ‡∏ù‡∏á‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)</div>
            <div class="subtle">‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏° ‡∏õ‡∏µ 2567</div>
          </div>

          <div style="overflow-x:auto;">
            <table>
              <thead>
                <tr>
                  <th>‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏° / ‡∏†‡∏≤‡∏Ñ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</th>
                  <th>‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏ô)</th>
                </tr>
              </thead>
              <tbody id="workforceTableBody">
                <!-- ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
              </tbody>
            </table>
          </div>
        </section>
      </div>
    </main>

    <footer>
      ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á ‡∏ñ‡∏ô‡∏ô‡∏™‡∏≤‡∏¢‡πÉ‡∏¢‡∏£‡∏±‡∏Å ‡∏û‡∏¥‡∏Å‡∏±‡∏î 13.565126,
      100.279895 ¬∑ Spatial Clustering: K-means ¬∑ Classification: Geometrical Interval
    </footer>

    <script>
      // ---------- helper format ----------
      function formatNumber(n) {
        return n.toLocaleString("th-TH");
      }

      // ---------- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ ----------
      function loadPopulation() {
        return fetch("data/population.json")
          .then((res) => res.json())
          .then((data) => {
            // 1) ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£
            const tbody = document.getElementById("populationTableBody");
            tbody.innerHTML = "";

            data.population_points.forEach((p) => {
              const tr = document.createElement("tr");

              // cluster badge ‡∏™‡∏µ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô
              const clusterClass = "cluster-" + p.cluster;

              tr.innerHTML = `
                <td>${p.amphoe}</td>
                <td>
                  <div style="color:#fff;font-weight:500;">${p.tambon_th}</div>
                  <div class="subtle" style="font-size:11px;">${p.tambon_en}</div>
                </td>
                <td style="color:#fff;font-weight:600;">${formatNumber(
                  p.population
                )}</td>
                <td>
                  <span class="cluster-badge ${clusterClass}">
                    ${p.cluster} ¬∑ ${p.class}
                  </span>
                </td>
                <td>${p.lat.toFixed(6)}</td>
                <td>${p.lng.toFixed(6)}</td>
              `;
              tbody.appendChild(tr);
            });

            // 2) ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏ß‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏ä‡∏ß‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
            const totalPop = data.population_points.reduce(
              (sum, p) => sum + (p.population || 0),
              0
            );

            // ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (hotspot)
            let maxTambon = null;
            data.population_points.forEach((p) => {
              if (!maxTambon || p.population > maxTambon.population) {
                maxTambon = p;
              }
            });

            return {
              totalPop,
              maxTambon,
              referencePoint: data.reference_point,
            };
          });
      }

      // ---------- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô ----------
      function loadWorkforce() {
        return fetch("data/workforce.json")
          .then((res) => res.json())
          .then((data) => {
            // ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á workforce
            const tbody = document.getElementById("workforceTableBody");
            tbody.innerHTML = "";

            data.sectors.forEach((s) => {
              const tr = document.createElement("tr");
              tr.innerHTML = `
                <td>
                  <div style="color:#fff;font-weight:500;">${s.sector}</div>
                </td>
                <td style="color:#fff;font-weight:600;">
                  ${formatNumber(s.workers)}
                </td>
              `;
              tbody.appendChild(tr);
            });

            return {
              totalWorkers: data.total_daytime_workers,
              yearBE: data.year_be,
            };
          });
      }

      // ---------- ‡∏£‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á fetch ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï quick stats ----------
      Promise.all([loadPopulation(), loadWorkforce()]).then(
        ([popStats, workStats]) => {
          const quickStats = document.getElementById("quickStats");

          quickStats.innerHTML = `
            <div class="stat-box">
              <div class="stat-label">‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏£‡∏ß‡∏° (‡∏ï‡∏≥‡∏ö‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)</div>
              <div class="stat-value">${formatNumber(
                popStats.totalPop
              )} ‡∏Ñ‡∏ô</div>
            </div>

            <div class="stat-box">
              <div class="stat-label">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏™‡∏∏‡∏î</div>
              <div class="stat-value" style="font-size:14px;line-height:1.4;">
                ${popStats.maxTambon.tambon_th} (${formatNumber(
            popStats.maxTambon.population
          )} ‡∏Ñ‡∏ô)
                <div style="font-size:11px;color:#94a3b8;font-weight:400;">
                  ‡∏≠.${popStats.maxTambon.amphoe}
                </div>
              </div>
            </div>

            <div class="stat-box">
              <div class="stat-label">‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô (‡∏õ‡∏µ ${
                workStats.yearBE
              })</div>
              <div class="stat-value">${formatNumber(
                workStats.totalWorkers
              )} ‡∏Ñ‡∏ô</div>
            </div>

            <div class="stat-box">
              <div class="stat-label">‡∏à‡∏∏‡∏î‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á)</div>
              <div class="stat-value" style="font-size:14px;line-height:1.4;">
                ${popStats.referencePoint.lat.toFixed(6)},
                ${popStats.referencePoint.lng.toFixed(6)}
                <div style="font-size:11px;color:#94a3b8;font-weight:400;">
                  ${popStats.referencePoint.desc}
                </div>
              </div>
            </div>
          `;
        }
      );
    </script>
  </body>
</html>
