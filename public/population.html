<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ & ‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏ù‡∏á - ‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- Heatmap plugin -->
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

  <style>
    :root {
      --bg-main:#0f172a;
      --bg-card:#1e293b;
      --bg-card-soft:rgba(30,41,59,.6);
      --line:#334155;
      --text-main:#f8fafc;
      --text-dim:#94a3b8;
      --text-soft:#cbd5e1;
      --accent:#38bdf8;
    }

    body{
      margin:0;
      background:var(--bg-main);
      color:var(--text-main);
      font-family:system-ui, sans-serif;
      min-height:100vh;
      display:grid;
      grid-template-rows:auto auto auto 1fr auto;
    }

    /* ---------- NAV TOP ---------- */
    header {
      background: var(--bg-card);
      border-bottom:1px solid var(--line);
      padding:12px 16px;
      font-size:14px;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    header .brand{
      font-weight:600;
      color:#fff;
      font-size:14px;
      line-height:1.4;
    }
    header nav a{
      color:var(--text-dim);
      text-decoration:none;
      font-size:13px;
      margin-right:12px;
    }
    header nav a:last-child{margin-right:0;}
    header nav a:hover{color:#fff;}

    /* ---------- HERO SUMMARY ---------- */
    .hero{
      padding:16px;
      background:radial-gradient(circle at 20% 20%,rgba(56,189,248,.15) 0%,rgba(15,23,42,0) 60%);
      border-bottom:1px solid var(--line);
    }
    .hero-title{
      font-size:16px;
      font-weight:600;
      color:#fff;
      margin:0 0 4px;
      line-height:1.4;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:8px;
    }
    .hero-sub{
      font-size:13px;
      color:var(--text-soft);
      line-height:1.5;
      max-width:800px;
    }

    /* ---------- KPI CARDS ---------- */
    .kpi-row{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(min(200px,100%),1fr));
      gap:12px;
      padding:16px;
      border-bottom:1px solid var(--line);
      background:var(--bg-main);
    }
    .kpi-card{
      background:var(--bg-card);
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px 16px;
      box-shadow:0 20px 60px rgb(0 0 0 / .7);
      min-height:90px;
    }
    .kpi-label{
      color:var(--text-dim);
      font-size:12px;
      line-height:1.4;
      margin-bottom:4px;
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
    }
    .kpi-value{
      font-size:20px;
      font-weight:600;
      color:#fff;
      line-height:1.2;
      margin-bottom:4px;
      display:flex;
      flex-wrap:wrap;
      align-items:baseline;
      gap:6px;
    }
    .kpi-note{
      font-size:11px;
      line-height:1.4;
      color:var(--text-soft);
    }

    /* ---------- MAP SECTION ---------- */
    .map-section{
      position:relative;
      padding:16px;
      background:#000;
      border-bottom:1px solid var(--line);
    }
    .map-shell{
      position:relative;
      border-radius:20px;
      border:1px solid var(--line);
      overflow:hidden;
      min-height:320px;
      box-shadow:0 30px 80px rgb(0 0 0 / .8);
      background:#000;
    }
    #map-pop{
      position:absolute;
      inset:0;
    }

    /* floating panel on map */
    .map-panel{
      position:absolute;
      top:16px;
      left:16px;
      z-index:500;
      background:var(--bg-card-soft);
      backdrop-filter:blur(8px);
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px 16px;
      color:var(--text-soft);
      font-size:12px;
      line-height:1.4;
      max-width:260px;
      box-shadow:0 20px 60px rgb(0 0 0 / .7);
    }
    .map-panel h3{
      margin:0 0 6px;
      font-size:13px;
      font-weight:600;
      color:#fff;
      line-height:1.4;
    }

    .map-legend{
      position:absolute;
      bottom:16px;
      left:16px;
      z-index:500;
      background:var(--bg-card-soft);
      border:1px solid var(--line);
      border-radius:12px;
      padding:12px 16px;
      color:var(--text-soft);
      font-size:12px;
      line-height:1.4;
      box-shadow:0 20px 60px rgb(0 0 0 / .7);
    }
    .legend-row{
      display:flex;
      align-items:center;
      gap:8px;
      margin-bottom:6px;
    }
    .legend-dot{
      width:18px;
      height:18px;
      border-radius:999px;
      border:2px solid #fff;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:10px;
      font-weight:600;
      box-shadow:0 8px 16px rgb(0 0 0 / .5);
      color:#fff;
      line-height:1;
    }

    .toggle-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:8px;
    }
    .toggle-row button{
      background:#1e293b;
      border:1px solid #475569;
      color:#fff;
      font-size:12px;
      line-height:1.3;
      padding:6px 10px;
      border-radius:10px;
      cursor:pointer;
    }
    .toggle-row button.active{
      background:var(--accent);
      color:#0f172a;
      border-color:var(--accent);
      font-weight:600;
    }

    /* ---------- TABLE POPULATION ---------- */
    .table-section{
      padding:16px;
    }
    .table-card{
      background:var(--bg-card);
      border:1px solid var(--line);
      border-radius:16px;
      box-shadow:0 20px 60px rgb(0 0 0 / .7);
      overflow-x:auto;
      padding:16px;
    }
    .table-title{
      font-size:14px;
      font-weight:600;
      color:#fff;
      margin:0 0 8px;
      line-height:1.4;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:baseline;
    }
    .table-sub{
      font-size:12px;
      color:var(--text-soft);
      line-height:1.4;
      margin:0 0 16px;
    }

    table{
      border-collapse:collapse;
      width:100%;
      min-width:600px;
      font-size:12px;
      line-height:1.4;
      color:var(--text-soft);
    }
    thead{
      background:#334155;
      color:#fff;
    }
    th,td{
      padding:8px 10px;
      border-bottom:1px solid #475569;
      text-align:left;
      white-space:nowrap;
    }
    tbody tr:hover{
      background:#1e2535;
    }
    .num{
      text-align:right;
      font-variant-numeric:tabular-nums;
      font-feature-settings:"tnum";
      color:#fff;
    }
    .subdistrict{
      color:#fff;
      font-weight:500;
    }
    .eng{
      color:var(--text-dim);
      font-weight:400;
      font-size:11px;
    }

    /* ---------- FOOTER ---------- */
    footer{
      color:#475569;
      background:#0f172a;
      font-size:12px;
      text-align:center;
      padding:12px 0 16px;
      border-top:1px solid var(--line);
    }

    /* Leaflet popup dark theme */
    .leaflet-popup-content-wrapper {
      background:#1e293b;
      color:#f8fafc;
      border-radius:12px;
      border:1px solid #475569;
      box-shadow:0 20px 60px rgb(0 0 0 / .8);
    }
    .leaflet-popup-tip {
      background:#1e293b;
      border:1px solid #475569;
    }
    .popup-title {
      font-size:14px;
      font-weight:600;
      color:#fff;
      margin-bottom:4px;
      line-height:1.4;
    }
    .popup-desc {
      font-size:12px;
      color:#cbd5e1;
      line-height:1.4;
    }
  </style>
</head>
<body>

  <!-- NAV -->
  <header>
    <div class="brand">
      ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£ ‚Ä¢ Data View
    </div>
    <nav>
      <a href="index.html">‡∏™‡∏£‡∏∏‡∏õ</a>
      <a href="map.html">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</a>
      <a href="competition.html">‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</a>
      <a href="population.html" style="color:#fff;">‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</a>
    </nav>
  </header>

  <!-- HERO -->
  <section class="hero">
    <h1 class="hero-title">
      üë• ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ & ‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏ù‡∏á (‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô)
    </h1>
    <p class="hero-sub">
      ‡∏°‡∏≠‡∏ô‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡∏ö‡∏•) + ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô (‡∏õ‡∏µ 2567) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π Demand ‡∏£‡∏≠‡∏ö‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°
    </p>
  </section>

  <!-- KPI -->
  <section class="kpi-row">
    <div class="kpi-card">
      <div class="kpi-label">
        <span>‡∏ï‡∏≥‡∏ö‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
        <span>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á</span>
      </div>
      <div class="kpi-value">
        ‡∏û‡∏±‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏ô‡∏£‡∏™‡∏¥‡∏á‡∏´‡πå <span style="font-size:13px;color:var(--accent);">43,687 ‡∏Ñ‡∏ô</span>
      </div>
      <div class="kpi-note">
        ‡πÇ‡∏ã‡∏ô‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å / ‡∏ô‡∏¥‡∏Ñ‡∏° / ‡πÉ‡∏Å‡∏•‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-label">
        <span>‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏ù‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô (‡∏£‡∏ß‡∏°)</span>
        <span>‡∏õ‡∏µ 2567</span>
      </div>
      <div class="kpi-value">
        30,408 <span style="font-size:13px;color:var(--accent);">‡∏Ñ‡∏ô</span>
      </div>
      <div class="kpi-note">
        ‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê / ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ ~10,287 ‡∏Ñ‡∏ô
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-label">
        <span>‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô‡∏´‡∏•‡∏±‡∏Å</span>
        <span>‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô</span>
      </div>
      <div class="kpi-value">
        ‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï <span style="font-size:13px;color:var(--accent);">4,798 ‡∏Ñ‡∏ô</span>
      </div>
      <div class="kpi-note">
        + ‡∏Ç‡∏≤‡∏¢‡∏™‡πà‡∏á/‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏µ‡∏Å 4,286 ‡∏Ñ‡∏ô
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-label">
        <span>‡∏à‡∏∏‡∏î‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</span>
        <span>‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á</span>
      </div>
      <div class="kpi-value">
        13.565126,
        <span style="font-size:13px;color:var(--accent);">100.279895</span>
      </div>
      <div class="kpi-note">
        ‡∏ñ‡∏ô‡∏ô‡∏™‡∏≤‡∏¢‡πÉ‡∏¢‡∏£‡∏±‡∏Å ‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô origin ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå catchment
      </div>
    </div>
  </section>

  <!-- MAP -->
  <section class="map-section">
    <div class="map-shell">
      <div id="map-pop"></div>

      <!-- left floating info -->
      <div class="map-panel">
        <h3>Heatmap ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</h3>
        <div style="font-size:12px; line-height:1.5;">
          ‡∏™‡∏µ‡∏£‡πâ‡∏≠‡∏ô = ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏¢‡∏≠‡∏∞ / ‡∏™‡∏µ‡∏≠‡πà‡∏≠‡∏ô = ‡πÄ‡∏ö‡∏≤‡∏ö‡∏≤‡∏á<br/>
          ‡∏à‡∏∏‡∏î = ‡∏ï‡∏≥‡∏ö‡∏• + ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£
        </div>

        <div class="toggle-row" style="margin-top:10px;">
          <button id="btnHeat" class="active">Heatmap</button>
          <button id="btnPoints">‡∏à‡∏∏‡∏î (Marker)</button>
        </div>
      </div>

      <!-- legend bottom -->
      <div class="map-legend">
        <div class="legend-row">
          <div class="legend-dot" style="background:#ef4444;border-color:#fff;">H</div>
          <div>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏™‡∏π‡∏á</div>
        </div>
        <div class="legend-row">
          <div class="legend-dot" style="background:#facc15;border-color:#fff;">M</div>
          <div>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
        </div>
        <div class="legend-row">
          <div class="legend-dot" style="background:#38bdf8;border-color:#fff;">L</div>
          <div>‡∏ï‡πà‡∏≥</div>
        </div>
      </div>
    </div>
  </section>

  <!-- TABLE -->
  <section class="table-section">
    <div class="table-card">
      <h2 class="table-title">
        ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡∏ö‡∏• + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏ (‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô)
      </h2>
      <p class="table-sub">
        ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö cross-check popup / heatmap
      </p>

      <div style="overflow-x:auto;">
        <table>
          <thead>
            <tr>
              <th>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</th>
              <th>‡∏ï‡∏≥‡∏ö‡∏• (TH / ENG)</th>
              <th class="num">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</th>
              <th>‡∏û‡∏¥‡∏Å‡∏±‡∏î</th>
            </tr>
          </thead>
          <tbody id="pop-table-body">
            <!-- ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á -->
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <footer>
    ¬© ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£ | Spatial Clustering K-means ‚Ä¢ Geometrical Interval Classification
  </footer>

  <!-- ============ DATA + MAP SCRIPT ============ -->
  <script>
    // ---------------------------
    // 1) DATA: ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ï‡πà‡∏≠ "‡∏ï‡∏≥‡∏ö‡∏•"
    //    ‡πÉ‡∏ä‡πâ subset ‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ)
    //    structure:
    //    { amphoe, tambonTH, tambonEN, pop, lat, lng }
    // ---------------------------

    const populationPoints = [
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢", tambonEN:"Maha Chai", pop:38607, lat:13.5497804, lng:100.274131 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ó‡πà‡∏≤‡∏â‡∏•‡∏≠‡∏°", tambonEN:"Tha Chalom", pop:7489, lat:13.4919384, lng:100.1871351 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡πÇ‡∏Å‡∏£‡∏Å‡∏Å‡∏£‡∏≤‡∏Å", tambonEN:"Krokkrak", pop:4654, lat:13.5297156, lng:100.2754365 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ö‡∏≤‡∏á‡πÇ‡∏ó‡∏£‡∏±‡∏î", tambonEN:"Bang Tho Rat", pop:8432, lat:13.513624, lng:100.1506066 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ô‡∏≤‡πÇ‡∏Ñ‡∏Å", tambonEN:"Na Khok", pop:3636, lat:13.4762506, lng:100.1013066 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ó‡πà‡∏≤‡∏à‡∏µ‡∏ô", tambonEN:"Tha Chin", pop:10879, lat:13.5497804, lng:100.274131 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ô‡∏≤‡∏î‡∏µ", tambonEN:"Na Di", pop:28318, lat:13.5984793, lng:100.3089904 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ó‡πà‡∏≤‡∏ó‡∏£‡∏≤‡∏¢", tambonEN:"Tha Sai", pop:32634, lat:13.5720976, lng:100.2722945 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏Ñ‡∏≠‡∏Å‡∏Å‡∏£‡∏∞‡∏ö‡∏∑‡∏≠", tambonEN:"Khok Krabue", pop:10593, lat:13.5878173, lng:100.3242768 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ö‡∏≤‡∏á‡∏ô‡πâ‡∏≥‡∏à‡∏∑‡∏î", tambonEN:"Bang Nam Chuet", pop:15802, lat:13.5878173, lng:100.3242768 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏û‡∏±‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏ô‡∏£‡∏™‡∏¥‡∏á‡∏´‡πå", tambonEN:"Phanthai Norasing", pop:43687, lat:13.5777724, lng:100.3656284 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡πÇ‡∏Ñ‡∏Å‡∏Ç‡∏≤‡∏°", tambonEN:"Khok Kham", pop:25122, lat:13.5497804, lng:100.274131 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤", tambonEN:"Bang Krachao", pop:11398, lat:13.5403306, lng:100.2116297 },
      { amphoe:"‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", tambonTH:"‡∏ö‡∏≤‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÅ‡∏û‡∏£‡∏Å", tambonEN:"Bang Ya Phraek", pop:26002, lat:13.5115627, lng:100.2656209 },

      { amphoe:"‡∏Å‡∏£‡∏∞‡∏ó‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ô", tambonTH:"‡∏≠‡πâ‡∏≠‡∏°‡∏ô‡πâ‡∏≠‡∏¢", tambonEN:"Om Noi", pop:53888, lat:13.7013895, lng:100.3143385 },
      { amphoe:"‡∏Å‡∏£‡∏∞‡∏ó‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ô", tambonTH:"‡∏™‡∏ß‡∏ô‡∏´‡∏•‡∏ß‡∏á", tambonEN:"Suan Luang", pop:39180, lat:13.6739044, lng:100.3184851 },
      { amphoe:"‡∏Å‡∏£‡∏∞‡∏ó‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ô", tambonTH:"‡∏Ñ‡∏•‡∏≠‡∏á‡∏°‡∏∞‡πÄ‡∏î‡∏∑‡πà‡∏≠", tambonEN:"Khlong Maduea", pop:22318, lat:13.6413115, lng:100.2988416 },

      { amphoe:"‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏û‡πâ‡∏ß", tambonTH:"‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≤‡∏°", tambonEN:"Lak Sam", pop:16653, lat:13.5988746, lng:100.0863269 },
      { amphoe:"‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏û‡πâ‡∏ß", tambonTH:"‡∏¢‡∏Å‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏ï‡∏£", tambonEN:"Yokkrabat", pop:15135, lat:13.5527008, lng:100.0975221 },
      { amphoe:"‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏û‡πâ‡∏ß", tambonTH:"‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏û‡πâ‡∏ß", tambonEN:"Ban Phaeo", pop:10273, lat:13.6644909, lng:100.131095 },
    ];

    // ---------------------------
    // 2) DATA: ‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏ù‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏° (‡∏™‡∏£‡∏∏‡∏õ)
    //    ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÑ‡∏ß‡πâ‡πÇ‡∏ä‡∏ß‡πå‡πÉ‡∏ô popup ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î
    // ---------------------------

    const workforceSummary = [
      { sector:"‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ / ‡∏£‡∏±‡∏ê", people:10287 },
      { sector:"‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï (‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô)", people:4798 },
      { sector:"‡∏Ç‡∏≤‡∏¢‡∏™‡πà‡∏á/‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏µ‡∏Å/‡∏ã‡πà‡∏≠‡∏°‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå", people:4286 },
      { sector:"‡∏Ç‡∏ô‡∏™‡πà‡∏á/‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", people:2594 },
      { sector:"‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô/‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏†‡∏±‡∏¢", people:3013 },
      { sector:"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£/‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£", people:1121 },
      { sector:"‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å+‡∏≠‡∏≤‡∏´‡∏≤‡∏£", people:1762 },
      { sector:"‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤", people:667 },
      { sector:"‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç/‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏™‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå", people:0 },
    ];
    // ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ): 30,408 ‡∏Ñ‡∏ô

    // ---------------------------
    // 3) ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    // ---------------------------
    const tableBodyEl = document.getElementById("pop-table-body");
    populationPoints.forEach(row=>{
      const tr=document.createElement("tr");

      const tdA=document.createElement("td");
      tdA.textContent=row.amphoe;

      const tdT=document.createElement("td");
      tdT.innerHTML = `
        <div class="subdistrict">${row.tambonTH}</div>
        <div class="eng">${row.tambonEN}</div>
      `;

      const tdP=document.createElement("td");
      tdP.className="num";
      tdP.textContent=row.pop.toLocaleString("th-TH");

      const tdC=document.createElement("td");
      tdC.textContent=`${row.lat.toFixed(6)}, ${row.lng.toFixed(6)}`;

      tr.appendChild(tdA);
      tr.appendChild(tdT);
      tr.appendChild(tdP);
      tr.appendChild(tdC);

      tableBodyEl.appendChild(tr);
    });

    // ---------------------------
    // 4) ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
    // ---------------------------
    const map = L.map("map-pop", {
      center: [13.565126,100.279895], // ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
      zoom: 11,
      zoomControl:true,
    });

    // base layers
    const baseRoad = L.tileLayer(
      "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
      {
        maxZoom: 19,
        attribution: "&copy; OpenStreetMap"
      }
    ).addTo(map);

    // ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° (Esri world imagery)
    const baseSat = L.tileLayer(
      "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
      {
        maxZoom: 20,
        attribution: "Tiles &copy; Esri"
      }
    );

    // ---------------------------
    // 5) ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏à‡∏∏‡∏î Heatmap
    //    leaflet-heat ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö [lat, lng, intensity(0-1)]
    //    ‡πÄ‡∏£‡∏≤‡∏à‡∏∞ normalize ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£
    //    ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏£‡πà‡∏≤‡∏ß ‡πÜ:
    //    - ‡∏´‡∏≤ pop ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
    //    - intensity = pop / popMax
    // ---------------------------

    const maxPop = Math.max(...populationPoints.map(p=>p.pop));
    const heatData = populationPoints.map(p => {
      return [p.lat, p.lng, p.pop / maxPop]; // intensity 0..1
    });

    // Heat layer
    const heatLayer = L.heatLayer(heatData, {
      radius: 30,
      blur: 20,
      maxZoom: 17,
      // gradient ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏ü‡πâ‡∏≤ -> ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á -> ‡πÅ‡∏î‡∏á
      gradient: {
        0.2: "#38bdf8",
        0.5: "#facc15",
        0.8: "#ef4444"
      }
    });

    // ---------------------------
    // 6) Marker layer (‡∏à‡∏∏‡∏î‡∏ï‡∏≥‡∏ö‡∏•)
    // ---------------------------

    const markerLayer = L.layerGroup();

    populationPoints.forEach(p=>{
      const circle = L.circleMarker([p.lat,p.lng], {
        radius: 6,
        color: "#fff",
        weight:1,
        fillColor:"#38bdf8",
        fillOpacity:0.9
      }).bindPopup(`
        <div class="popup-title">${p.tambonTH} (${p.tambonEN})</div>
        <div class="popup-desc">
          ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠: ${p.amphoe}<br/>
          ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£: ${p.pop.toLocaleString("th-TH")} ‡∏Ñ‡∏ô<br/>
          ‡∏û‡∏¥‡∏Å‡∏±‡∏î: ${p.lat.toFixed(5)}, ${p.lng.toFixed(5)}
        </div>
      `);
      markerLayer.addLayer(circle);
    });

    // ---------------------------
    // 7) ‡∏à‡∏∏‡∏î‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á (origin)
    // ---------------------------
    const redBullLat = 13.565126;
    const redBullLng = 100.279895;

    const redIcon = L.divIcon({
      className:"custom-redbull-pin",
      html: `
        <div style="
          background:#ef4444;
          color:#fff;
          border:2px solid #fff;
          width:20px;height:20px;
          border-radius:999px;
          font-size:11px;
          font-weight:600;
          display:flex;
          align-items:center;
          justify-content:center;
          box-shadow:0 12px 24px rgb(0 0 0 / .8);
        ">RB</div>
      `,
      iconSize:[20,20],
      iconAnchor:[10,10]
    });

    const redBullMarker = L.marker([redBullLat, redBullLng], {icon:redIcon})
      .bindPopup(`
        <div class="popup-title">‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á (‡∏à‡∏∏‡∏î‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)</div>
        <div class="popup-desc">
          ‡∏ñ‡∏ô‡∏ô‡∏™‡∏≤‡∏¢‡πÉ‡∏¢‡∏£‡∏±‡∏Å<br/>
          ‡∏û‡∏¥‡∏Å‡∏±‡∏î: ${redBullLat}, ${redBullLng}<br/>
          ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Catchment / ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô
        </div>
      `);

    markerLayer.addLayer(redBullMarker);
    heatLayer.addTo(map); // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏™‡∏î‡∏á heat ‡∏Å‡πà‡∏≠‡∏ô

    // ---------------------------
    // 8) Layer control (‡∏ñ‡∏ô‡∏ô / ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏°)
    // ---------------------------
    const baseMaps = {
      "‡∏ñ‡∏ô‡∏ô / OSM": baseRoad,
      "‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° / Esri": baseSat
    };

    const overlayMaps = {
      "Heatmap ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£": heatLayer,
      "‡∏ï‡∏≥‡∏ö‡∏• (‡∏à‡∏∏‡∏î)": markerLayer
    };

    L.control.layers(baseMaps, overlayMaps, {collapsed:true}).addTo(map);

    // ---------------------------
    // 9) ‡∏õ‡∏∏‡πà‡∏° toggle (Heatmap vs Marker)
    //    - Heatmap on by default
    // ---------------------------

    const btnHeat = document.getElementById("btnHeat");
    const btnPoints = document.getElementById("btnPoints");

    function showHeat(){
      if(!map.hasLayer(heatLayer)) map.addLayer(heatLayer);
      if(map.hasLayer(markerLayer)) map.removeLayer(markerLayer);
      btnHeat.classList.add("active");
      btnPoints.classList.remove("active");
    }

    function showPoints(){
      if(!map.hasLayer(markerLayer)) map.addLayer(markerLayer);
      if(map.hasLayer(heatLayer)) map.removeLayer(heatLayer);
      btnPoints.classList.add("active");
      btnHeat.classList.remove("active");
    }

    btnHeat.addEventListener("click", showHeat);
    btnPoints.addEventListener("click", showPoints);

    // ---------------------------
    // 10) Fit map bounds ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡∏ö‡∏• + ‡∏à‡∏∏‡∏î RB
    // ---------------------------
    const allLatLngs = populationPoints.map(p=>[p.lat,p.lng]);
    allLatLngs.push([redBullLat, redBullLng]);
    const bounds = L.latLngBounds(allLatLngs);
    map.fitBounds(bounds.pad(0.2)); // padding ‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢

  </script>
</body>
</html>
