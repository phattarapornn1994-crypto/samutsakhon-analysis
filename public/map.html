<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô & ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á - ‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£</title>

  <!-- Leaflet CSS ‡∏à‡∏≤‡∏Å CDN -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- Leaflet JS ‡∏à‡∏≤‡∏Å CDN -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á / UI ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤ index -->
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #0f172a;
      color: #f8fafc;
      margin: 0;
      padding: 0;
      display: grid;
      grid-template-rows: auto 1fr auto;
      height: 100vh;
    }

    header {
      background: #1e293b;
      padding: 12px 16px;
      border-bottom: 1px solid #334155;
      font-size: 14px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    header nav a {
      color: #94a3b8;
      margin-right: 12px;
      text-decoration: none;
      font-size: 13px;
    }
    header nav a:hover {
      color: #fff;
    }

    #map-wrapper {
      position: relative;
      background: #000;
    }

    #map {
      width: 100%;
      height: 100%;
      min-height: 400px;
      /* ‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
      position: absolute;
      inset: 0;
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á info ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ */
    .info-panel {
      position: absolute;
      top: 16px;
      left: 16px;
      z-index: 500;
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(8px);
      border: 1px solid #334155;
      border-radius: 16px;
      padding: 16px 20px;
      max-width: 260px;
      box-shadow: 0 20px 60px rgb(0 0 0 / .7);
      font-size: 13px;
      line-height: 1.5;
      color: #cbd5e1;
    }

    .info-panel h2 {
      margin: 0 0 8px;
      font-size: 14px;
      font-weight: 600;
      color: #fff;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á legend ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ */
    .legend-panel {
      position: absolute;
      bottom: 16px;
      left: 16px;
      z-index: 500;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid #334155;
      border-radius: 12px;
      padding: 12px 16px;
      font-size: 12px;
      color: #cbd5e1;
      line-height: 1.4;
      box-shadow: 0 20px 60px rgb(0 0 0 / .7);
    }

    .legend-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .legend-dot {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      border: 2px solid #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      box-shadow: 0 8px 16px rgb(0 0 0 / .5);
      font-weight: 600;
      color: #fff;
    }

    footer {
      color:#475569;
      background:#0f172a;
      font-size:12px;
      text-align:center;
      padding:12px 0 16px;
      border-top:1px solid #334155;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö popup ‡∏Ç‡∏≠‡∏á Leaflet ‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ö‡∏ô‡∏ò‡∏µ‡∏°‡∏°‡∏∑‡∏î */
    .leaflet-popup-content-wrapper {
      background:#1e293b;
      color:#f8fafc;
      border-radius:12px;
      border:1px solid #475569;
      box-shadow:0 20px 60px rgb(0 0 0 / .8);
    }
    .leaflet-popup-tip {
      background:#1e293b;
      border:1px solid #475569;
    }
    .popup-title {
      font-size:14px;
      font-weight:600;
      color:#fff;
      margin-bottom:4px;
      line-height:1.4;
    }
    .popup-desc {
      font-size:12px;
      color:#cbd5e1;
      line-height:1.4;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö layer control ‡∏Ç‡∏≠‡∏á Leaflet (‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô) ‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ */
    .leaflet-control-layers {
      background:#1e293b !important;
      border:1px solid #334155 !important;
      border-radius:12px !important;
      color:#fff !important;
      box-shadow:0 20px 60px rgb(0 0 0 / .8) !important;
      font-size:12px;
      line-height:1.4;
    }
    .leaflet-control-layers-expanded {
      background:#1e293b !important;
      color:#fff !important;
    }
    .leaflet-control-layers-list label {
      color:#cbd5e1;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:6px;
      margin-bottom:4px;
    }
  </style>
</head>
<body>

  <!-- HEADER / NAV -->
  <header>
    <div style="font-weight:600;color:#fff;font-size:14px;white-space:nowrap;">
      üó∫Ô∏è ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô & ‡∏à‡∏∏‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á
    </div>
    <nav style="display:flex;flex-wrap:wrap;align-items:center;">
      <a href="./index.html">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
      <a href="./map.html" style="color:#fff;">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà / ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</a>
      <a href="./demographic.html">‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</a>
      <a href="./competition.html">‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</a>
    </nav>
  </header>

  <!-- MAP AREA -->
  <section id="map-wrapper">
    <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ -->
    <aside class="info-panel">
      <h2>
        <span>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</span>
        <span style="font-size:12px;color:#94a3b8;font-weight:400;">(‡∏£‡∏±‡∏®‡∏°‡∏µ‡∏£‡∏≠‡∏ö‡∏•‡∏≤‡∏ô)</span>
      </h2>
      <div>
        <div style="color:#fff;font-size:13px;font-weight:500;line-height:1.4;">
          ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á‡πÉ‡∏´‡∏°‡πà üìå
        </div>
        <div style="font-size:12px;line-height:1.4;color:#cbd5e1;">
          ‡∏û‡∏¥‡∏Å‡∏±‡∏î: 13.565126, 100.279895<br/>
          ‡∏ñ‡∏ô‡∏ô‡∏™‡∏≤‡∏¢‡πÉ‡∏¢‡∏£‡∏±‡∏Å, ‡∏à.‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£
        </div>
      </div>

      <div style="height:8px;"></div>

      <div style="font-size:12px;line-height:1.4;">
        ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå:
        <ul style="margin:4px 0 0 16px;padding:0;">
          <li>‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£/‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢)</li>
          <li>‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•/‡πÄ‡∏Ñ‡∏°‡∏µ (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°)</li>
          <li>‡∏Ñ‡∏•‡∏±‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢</li>
        </ul>
      </div>

      <div style="height:8px;"></div>

      <div style="font-size:11px;color:#64748b;line-height:1.4;">
        ‡∏õ‡∏£‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏°‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
        (Street / ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° / ‡∏ú‡∏™‡∏° / ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô / Heatmap)
      </div>
    </aside>

    <!-- Legend -->
    <aside class="legend-panel">
      <div class="legend-row">
        <div class="legend-dot" style="background:#ef4444;">üìå</div>
        <div>‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á</div>
      </div>
      <div class="legend-row">
        <div class="legend-dot" style="background:#10b981;">‚ôª</div>
        <div>‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• / ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢</div>
      </div>
      <div class="legend-row">
        <div class="legend-dot" style="background:#38bdf8;">‚ùÑ</div>
        <div>‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô / ‡∏ä‡∏≥‡πÅ‡∏´‡∏•‡∏∞‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ô‡πâ‡∏≥</div>
      </div>
      <div class="legend-row">
        <div class="legend-dot" style="background:#facc15;">üç§</div>
        <div>‡∏≠‡∏≤‡∏´‡∏≤‡∏£ / ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</div>
      </div>
      <div class="legend-row">
        <div class="legend-dot" style="background:#94a3b8;">‚öô</div>
        <div>‡∏≠‡∏∑‡πà‡∏ô‡πÜ / ‡πÇ‡∏•‡∏´‡∏∞ / ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô</div>
      </div>
    </aside>

    <!-- ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏£‡∏¥‡∏á -->
    <div id="map"></div>
  </section>

  <footer>
    ¬© ‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£ Analysis Dashboard ‚Äî ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå
  </footer>


  <!-- ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà -->
  <script>
    // 1) ‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á: ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á‡πÉ‡∏´‡∏°‡πà
    const siteLat = 13.565126;
    const siteLng = 100.279895;

    // 2) ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° map instance
    const map = L.map("map", {
      center: [siteLat, siteLng],
      zoom: 12,
    });

    // -----------------------------
    // 3) Base layers (‡∏ñ‡∏ô‡∏ô / ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° / ‡∏ú‡∏™‡∏°)
    // -----------------------------

    // ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏ô‡∏ô (OpenStreetMap)
    const streetLayer = L.tileLayer(
      "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
      {
        maxZoom: 19,
        attribution: "¬© OpenStreetMap contributors",
      }
    );

    // ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° (Esri World Imagery)
    const satelliteLayer = L.tileLayer(
      "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
      {
        maxZoom: 19,
        attribution: "Tiles ¬© Esri",
      }
    );

    // "‡∏ú‡∏™‡∏°" = ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° + ‡πÄ‡∏™‡πâ‡∏ô‡∏ñ‡∏ô‡∏ô‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™
    // ‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå (LayerGroup)
    const hybridGroup = L.layerGroup([
      satelliteLayer,
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        opacity: 0.35, // ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™‡πÄ‡∏´‡πá‡∏ô‡∏ñ‡∏ô‡∏ô‡∏•‡∏≠‡∏¢‡∏ö‡∏ô‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢
        attribution: "¬© OpenStreetMap contributors + Esri",
      }),
    ]);

    // ‡πÉ‡∏™‡πà layer ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
    streetLayer.addTo(map);

    // -----------------------------
    // 4) ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á icon ‡πÅ‡∏ö‡∏ö bubble ‡∏™‡∏µ + ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥
    // -----------------------------
    function makeDivIcon(emoji, bgColor) {
      return L.divIcon({
        className: "",
        html: `
          <div style="
            background:${bgColor};
            color:#fff;
            border-radius:9999px;
            border:2px solid #fff;
            font-size:14px;
            line-height:20px;
            width:28px;
            height:28px;
            display:flex;
            align-items:center;
            justify-content:center;
            box-shadow:0 8px 16px rgba(0,0,0,0.45);
            font-weight:600;
          ">
            ${emoji}
          </div>`,
        iconSize: [28, 28],
        iconAnchor: [14, 14],
        popupAnchor: [0, -14],
      });
    }

    const ICONS = {
      site: makeDivIcon("üìå", "#ef4444"),      // ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á
      recycle: makeDivIcon("‚ôª", "#10b981"),   // ‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• / ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢
      cold: makeDivIcon("‚ùÑ", "#38bdf8"),      // ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô / ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ô‡πâ‡∏≥
      food: makeDivIcon("üç§", "#facc15"),      // ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ / ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°
      other: makeDivIcon("‚öô", "#94a3b8"),     // ‡∏≠‡∏∑‡πà‡∏ô‡πÜ / ‡πÇ‡∏•‡∏´‡∏∞ / ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö
    };

    // -----------------------------
    // 5) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß Step ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
    //    ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏≠‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡πÅ‡∏´‡πà‡∏á‡∏£‡∏≠‡∏ö‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢ / ‡∏ô‡∏≤‡∏î‡∏µ / ‡∏ö‡∏≤‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÅ‡∏û‡∏£‡∏Å
    // -----------------------------
    const factories = [
      {
        name: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏û‡∏µ ‡∏û‡∏µ ‡πÄ‡∏≠‡πá‡∏ô ‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î ‡∏ß‡∏¥‡∏ä‡∏ä‡∏¥‡πà‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î",
        desc: "‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ô‡πâ‡∏≥ + ‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á",
        type: "cold",
        lat: 13.5633684,
        lng: 100.2471886,
      },
      {
        name: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ß‡πà‡∏≤‡∏ô‡∏ü‡∏¥‡∏ä‡πÄ‡∏ä‡∏≠‡∏£‡∏µ‡πà‡∏™‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î",
        desc: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á",
        type: "cold",
        lat: 13.5354972,
        lng: 100.2577222,
      },
      {
        name: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏Æ‡∏∏‡∏¢‡πÄ‡∏ô‡∏á ‡∏´‡∏á‡πÄ‡∏ä‡∏á ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏™‡∏ó‡∏£‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î",
        desc: "‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß (‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•)",
        type: "recycle",
        lat: 13.525662,
        lng: 100.226612,
      },
      {
        name: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ã‡∏µ‡∏û‡∏µ‡πÄ‡∏≠‡∏ü ‡∏ü‡∏π‡πâ‡∏î ‡πÅ‡∏≠‡∏ô‡∏î‡πå ‡πÄ‡∏ö‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏à ‡∏à‡∏≥‡∏Å‡∏±‡∏î",
        desc: "‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ / ‡∏ú‡∏±‡∏Å / ‡∏ú‡∏•‡πÑ‡∏°‡πâ",
        type: "food",
        lat: 13.512959,
        lng: 100.158482,
      },
      {
        name: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÑ‡∏ó‡∏¢ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏°‡∏ô‡∏π‡πÅ‡∏ü‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏£‡∏¥‡πà‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î",
        desc: "‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ / ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå",
        type: "other",
        lat: 13.60547,
        lng: 100.27761,
      },
    ];

    // -----------------------------
    // 6) ‡∏Å‡∏•‡∏∏‡πà‡∏° marker ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î
    //    ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÉ‡∏ô Layer Control ‡πÑ‡∏î‡πâ
    // -----------------------------
    const layerSite = L.layerGroup().addTo(map);      // ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á
    const layerRecycle = L.layerGroup().addTo(map);   // ‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•
    const layerCold = L.layerGroup().addTo(map);      // ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô/‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ô‡πâ‡∏≥
    const layerFood = L.layerGroup().addTo(map);      // ‡∏≠‡∏≤‡∏´‡∏≤‡∏£/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°
    const layerOther = L.layerGroup().addTo(map);     // ‡∏≠‡∏∑‡πà‡∏ô‡πÜ

    // ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á‡πÉ‡∏´‡∏°‡πà
    L.marker([siteLat, siteLng], { icon: ICONS.site })
      .addTo(layerSite)
      .bindPopup(`
        <div class="popup-title">‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á‡πÉ‡∏´‡∏°‡πà üìå</div>
        <div class="popup-desc">
          ‡∏û‡∏¥‡∏Å‡∏±‡∏î 13.565126, 100.279895<br/>
          ‡∏ñ‡∏ô‡∏ô‡∏™‡∏≤‡∏¢‡πÉ‡∏¢‡∏£‡∏±‡∏Å ‡∏à.‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£
        </div>
      `);

    // ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°
    factories.forEach((f) => {
      const layerMapByType = {
        recycle: layerRecycle,
        cold: layerCold,
        food: layerFood,
        other: layerOther,
      };

      const iconByType = {
        recycle: ICONS.recycle,
        cold: ICONS.cold,
        food: ICONS.food,
        other: ICONS.other,
      };

      const targetLayer = layerMapByType[f.type] || layerOther;
      const icon = iconByType[f.type] || ICONS.other;

      L.marker([f.lat, f.lng], { icon })
        .addTo(targetLayer)
        .bindPopup(`
          <div class="popup-title">${f.name}</div>
          <div class="popup-desc">${f.desc}</div>
        `);
    });

    // -----------------------------
    // 7) (‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ) Heatmap Layer
    //    NOTE: ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏•‡∏±‡πä‡∏Å‡∏≠‡∏¥‡∏ô heatmap.js
    //    ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÉ‡∏ô Step ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏â‡∏±‡∏ô‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏¥‡πà‡∏° CDN heatmap ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
    // -----------------------------
    // ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏ß‡∏≤‡∏á placeholder ‡πÑ‡∏ß‡πâ‡πÄ‡∏â‡∏¢ ‡πÜ
    const layerHeatmap = L.layerGroup();
    // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏à‡∏∏‡∏î‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏≠‡∏ö‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢/‡∏ó‡πà‡∏≤‡∏ó‡∏£‡∏≤‡∏¢/‡∏ö‡∏≤‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÅ‡∏û‡∏£‡∏Å‡πÉ‡∏ô Step ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ

    // -----------------------------
    // 8) Layer Control (‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô)
    //    - ‡∏™‡∏•‡∏±‡∏ö Base layer: ‡∏ñ‡∏ô‡∏ô / ‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° / ‡∏ú‡∏™‡∏°
    //    - ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Overlay: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô, Heatmap
    // -----------------------------
    const baseMaps = {
      "‡∏ñ‡∏ô‡∏ô (Street)": streetLayer,
      "‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° (Satellite)": satelliteLayer,
      "‡∏ú‡∏™‡∏° (Hybrid)": hybridGroup,
    };

    const overlayMaps = {
      "üìå ‡∏•‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏¥‡∏á‡πÅ‡∏î‡∏á": layerSite,
      "‚ôª ‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• / ‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢": layerRecycle,
      "‚ùÑ ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô / ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ô‡πâ‡∏≥": layerCold,
      "üç§ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ / ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°": layerFood,
      "‚öô ‡∏≠‡∏∑‡πà‡∏ô‡πÜ / ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô": layerOther,
      "üî• Heatmap ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô": layerHeatmap,
    };

    L.control.layers(baseMaps, overlayMaps, { collapsed: false }).addTo(map);

    // -----------------------------
    // 9) Zoom map ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á cluster ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏ã‡∏ï‡πå
    // -----------------------------
    const bounds = L.latLngBounds([
      [siteLat, siteLng],
      ...factories.map(f => [f.lat, f.lng]),
    ]);
    map.fitBounds(bounds.pad(0.2)); // ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏≠‡∏ö‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏≠‡∏á‡∏™‡∏ö‡∏≤‡∏¢‡πÜ
  </script>
</body>
</html>
